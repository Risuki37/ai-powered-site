# データベースマイグレーションエラー対処

## 📋 現在の状況

データベースマイグレーション実行時に以下のエラーが発生しています：

```
Error: Invalid default value for 'createdAt'
```

## 🔍 原因

MySQL 8.0.21で、Prismaが生成するSQLクエリが、DATETIME型のデフォルト値設定で問題を起こしている可能性があります。

## ✅ 完了した作業

1. ✅ MySQLサーバーの起動確認
2. ✅ データベース`ai_powered_site_dev`の作成
3. ✅ ユーザー`dev_user`の作成と権限付与
4. ✅ 環境変数ファイル（`.env`）の設定
5. ✅ データベース接続の確認

## 🔧 対処方法

### オプション1: Prismaのバージョンアップ（推奨）

Prismaを最新バージョンに更新：

```bash
npm install prisma@latest @prisma/client@latest
npm run db:generate
```

### オプション2: 一時的に`db push`を使用（開発環境のみ）

マイグレーションファイルを作成せずに、直接データベーススキーマを同期：

```bash
npx prisma db push --accept-data-loss
```

ただし、現在は同じエラーが発生しています。

### オプション3: 手動でSQLを実行

Prismaスキーマから直接SQLを生成して、手動で実行することも可能です。

### オプション4: Prismaスキーマの修正

`@default(now())`を削除して、アプリケーション側でデフォルト値を設定する方法もあります。

## 📝 次のステップ

1. Prismaのバージョンを確認して、最新バージョンに更新を試みる
2. エラーメッセージの詳細を確認して、どのテーブルで問題が発生しているか特定
3. Prismaの公式ドキュメントを参照して、MySQL 8.0でのベストプラクティスを確認

## 🔗 参考リンク

- [Prisma MySQL Documentation](https://www.prisma.io/docs/concepts/database-connectors/mysql)
- [MySQL 8.0 DateTime Default Values](https://dev.mysql.com/doc/refman/8.0/en/data-type-defaults.html)

---

**最終更新**: 2025-11-29

